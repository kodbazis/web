[{"timestamp":0,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":11.4,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":11.9,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    \n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":13.266,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    []\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":13.983,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":16.966,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":17.5,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', ]\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":17.733,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":18.283,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":18.833,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":20.466,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":25.033,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":25.5,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nf\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":26.216,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction \n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":26.416,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":26.966,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":27.716,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() {\n    \n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":28.85,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":29.816,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    \n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":30.5,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":37.266,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    \n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":42.116,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml');\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":43.766,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', );\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":45.25,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        \n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":45.45,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        ''\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":46.033,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content'\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":46.816,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' =>\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":47.133,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => \n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":47.5,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml')\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":58.549,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', )\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":59.1,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":59.516,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":59.966,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTy'\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":60.416,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes'\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":61.466,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' =>\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":61.7,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":62.2,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":64.016,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":67.799,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":69.65,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":79.766,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\n\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":80.383,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfun\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":80.549,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":80.799,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction \n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":82.066,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction get\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":82.816,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAll\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":83.216,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDish\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":83.483,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTyp\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":84.049,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":84.383,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    \n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":86.549,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":87.083,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":88.683,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":88.933,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return \n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":89.75,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return  \n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":90.833,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":91.416,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dis\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":91.483,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dish\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":92,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":92.349,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":93.966,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":96.849,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes()\n{\n    $pdo = getConnection(); \n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":100.183,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes()\n{\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":100.733,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes()\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":102.516,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":111.983,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":114.65,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":115.033,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":115.366,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes; \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":115.599,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes(); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":117.166,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":121.883,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":126.283,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":126.933,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":129.699,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":133.833,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":136.166,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $dishTypes = getAllDishTypes($pdo); \n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":139.65,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    \n    $dishTypes = getAllDishTypes($pdo); \n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":141.783,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":147.15,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":147.849,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":148.883,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var_dump()\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":150.083,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var_dump($dishTypes);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":150.3,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var_dump($dishTypes);\n    \n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":150.65,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var_dump($dishTypes);\n    exit;\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":155.15,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var_dump($dishTypes);\n    exit;\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":155.466,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var_dump($dishTypes);\n    exit;\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":156.533,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    \n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":157.4,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":157.716,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":161.15,"fileName":"create-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\"> \n                            <option value=\"1\">\n                                Levesek </option>\n                            <option value=\"2\">\n                                Főételek </option>\n                            <option value=\"3\">\n                                Desszertek </option>\n                            <option value=\"4\">\n                                Italok </option>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":171.616,"fileName":"edit-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3><?= $params['dish']['name'] ?></h3>\n            <form action=\"/update-dish/<?= $params['dish']['id'] ?>\" method=\"POST\"> \n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\" value=\"<?= $params['dish']['name'] ?>\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputSlug\" class=\"col-sm-2 col-form-label\">Keresőbarát név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputSlug\" name=\"slug\" value=\"<?= $params['dish']['slug'] ?>\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"><?= $params['dish']['description'] ?></textarea>\n                    </div>\n                </div>\n\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\" value=\"<?= $params['dish']['price'] ?>\">\n                    </div>\n                </div>\n\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?> \n                                <option value=\"<?= $dishType['id'] ?>\" <?= $dishType['id'] === $params['dish']['dishTypeId'] ? \"selected\" : \"\" ?> >\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n\n                        </select>\n                    </div>\n                </div>\n\n                <div class=\"form-group row pb-3\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\" <?= $params['dish']['isActive'] === \"0\" ? \"\" : \"checked\" ?>>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":173.733,"fileName":"create-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n                            <option value=\"1\">\n                                Levesek </option>\n                            <option value=\"2\">\n                                Főételek </option>\n                            <option value=\"3\">\n                                Desszertek </option>\n                            <option value=\"4\">\n                                Italok </option>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":174.099,"fileName":"edit-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3><?= $params['dish']['name'] ?></h3>\n            <form action=\"/update-dish/<?= $params['dish']['id'] ?>\" method=\"POST\"> \n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\" value=\"<?= $params['dish']['name'] ?>\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputSlug\" class=\"col-sm-2 col-form-label\">Keresőbarát név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputSlug\" name=\"slug\" value=\"<?= $params['dish']['slug'] ?>\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"><?= $params['dish']['description'] ?></textarea>\n                    </div>\n                </div>\n\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\" value=\"<?= $params['dish']['price'] ?>\">\n                    </div>\n                </div>\n\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?>  \n                                <option value=\"<?= $dishType['id'] ?>\" <?= $dishType['id'] === $params['dish']['dishTypeId'] ? \"selected\" : \"\" ?> >\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n\n                        </select>\n                    </div>\n                </div>\n\n                <div class=\"form-group row pb-3\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\" <?= $params['dish']['isActive'] === \"0\" ? \"\" : \"checked\" ?>>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":178.716,"fileName":"create-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\"> \n                        <?php foreach ($params['dishTypes'] as $dishType) : ?>  \n                                <option value=\"<?= $dishType['id'] ?>\" <?= $dishType['id'] === $params['dish']['dishTypeId'] ? \"selected\" : \"\" ?> >\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":179.866,"fileName":"create-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?>\n                                <option value=\"<?= $dishType['id'] ?>\" <?= $dishType['id'] === $params['dish']['dishTypeId'] ? \"selected\" : \"\" ?>>\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":182.516,"fileName":"create-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?>\n                                <option value=\"<?= $dishType['id'] ?>\"  <?= $dishType['id'] === $params['dish']['dishTypeId'] ? \"selected\" : \"\" ?>>\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":185.783,"fileName":"create-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?>\n                                <option value=\"<?= $dishType['id'] ?>\" >\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":186.316,"fileName":"create-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?>\n                                <option value=\"<?= $dishType['id'] ?>\">\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":194.083,"fileName":"create-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\"> \n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?>\n                                <option value=\"<?= $dishType['id'] ?>\">\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":207.966,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":208.433,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    \n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":208.933,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    []\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":209.949,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":210.833,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":211.733,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', ]\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":212.016,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":212.483,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":213.849,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', ]\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":214.449,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":215.733,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'create']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":216.466,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDi']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":216.733,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDish']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":217.533,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHan']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":217.75,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":220.15,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":220.4,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfun\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":221,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction \n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":221.216,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":221.949,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":222.366,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler() \n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":222.966,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler() {\n    \n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":223.716,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":224.55,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    \n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":228.55,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":229.416,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    \n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":230.949,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n\n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":234.683,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":235.816,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (?, ?, ?, ?, ?, ?);\"\n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":237.383,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`)  \n        VALUES \n        (?, ?, ?, ?, ?, ?);\"\n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":238.683,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (?, ?, ?, ?, ?, ?);\" \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":257.766,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (, ?, ?, ?, ?, ?);\" \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":258.283,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, ?, ?, ?, ?, ?);\" \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":262.033,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, ?, ?, ?, ?);\" \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":263.433,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, ?, ?, ?);\" \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":264.033,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":266.183,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \n        ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":267.616,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":272.5,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"  \n    );\n\n    $stmt->execute([\n       \n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":280.35,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"\"\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":281.333,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"le\"\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":282.5,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"lei\"\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":283.516,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => \n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":285.899,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":288.483,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":288.766,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":289.333,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":289.633,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":290.683,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":292.033,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId']\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":293.816,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":294.399,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":295.516,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"\"\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":296.183,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\"\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":296.533,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" =\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":297,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => \n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":297.466,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => sl\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":297.733,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugi\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":298.116,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":298.516,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify()\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":300.3,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify(),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":301.783,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":302.133,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":302.366,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":302.733,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST[]),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":303.8,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST['']),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":304.483,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST['nam']),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":304.699,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST['name']),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":307.066,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"nev\" => $_POST['name'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":313.183,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST['name']),\n        \"nev\" => $_POST['name'],\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":313.85,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":315.8,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":325.516,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    \n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":327.483,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":351.899,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    \n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":353.3,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    []\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":353.5,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":354.199,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":354.333,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":354.766,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delet']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":355.016,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":355.5,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-di']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":355.85,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":356.616,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{}']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":357.25,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dish}']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":358.783,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishI}']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":359.466,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":361.833,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', ]\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":362.283,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":363.983,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'de']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":364.199,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'delete']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":364.483,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteD']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":365.05,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDish']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":365.75,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":368.75,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction \n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":369.149,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":369.516,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler()\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":370.083,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler()\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":371.266,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($)\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":371.816,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($u)\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":372.083,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($url)\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":372.816,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlPar)\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":373.583,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParam)\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":373.8,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":374.1,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    v\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":374.25,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":375.399,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump()\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":375.583,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":385.516,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    \n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":385.699,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":387.083,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n\n    \n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":388.883,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    \n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":389.149,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":391.116,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    \n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":391.399,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":392.283,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    \n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":392.783,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":393.233,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":393.783,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->exec\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":394.75,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute()\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":394.85,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        \n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":397.699,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek\n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":398.716,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek[]\n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":399.283,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['']\n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":399.883,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dish']\n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":400.333,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishI']\n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":400.816,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":401.766,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":403.8,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    \n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":404.949,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":405.8,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":407.5,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":408.116,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":423.35,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":424,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    \n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":424.866,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":425.666,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":425.949,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":426.883,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', ]\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":428.333,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":429,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":431.033,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":431.55,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction \n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":431.949,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":432.399,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":432.699,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler() \n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":433.166,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler() {\n    \n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":434.783,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler() {\n    redirectToLoginPageIfNotLoggedIn();\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":435.616,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":436.449,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    \n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":437.416,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":440.566,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    \n\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":441.283,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":444.016,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    \n\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":444.766,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":451.966,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":455.116,"fileName":"dish-type-list.phtml","content":"<section class=\"ftco-section\"> \n  <div class=\"container\">\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n        <div class=\"row mb-4 border-bottom border-dark\">\n          <div class=\"d-flex\">\n            <div class=\"desc pl-3\">\n              <div class=\"d-flex text align-items-center\">\n                <h3><span>Levesek</span></h3>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"row mb-4 border-bottom border-dark\">\n          <div class=\"d-flex \">\n            <div class=\"desc pl-3\">\n              <div class=\"d-flex text align-items-center\">\n                <h3><span>Főételek</span></h3>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"row mb-4 border-bottom border-dark\">\n          <div class=\"d-flex \">\n            <div class=\"desc pl-3\">\n              <div class=\"d-flex text align-items-center\">\n                <h3><span>Desszertek</span></h3>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"row mb-4 border-bottom border-dark\">\n          <div class=\"d-flex \">\n            <div class=\"desc pl-3\">\n              <div class=\"d-flex text align-items-center\">\n                <h3><span>Italok</span></h3>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"col-md-12 mb-5 pb-3\">\n      <h3>Új ételtípus létrehozása</h3>\n      <form action=\"/create-dish-type\" method=\"POST\">\n        <div class=\"form-group row\">\n          <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n          <div class=\"col-sm-10\">\n            <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n          </div>\n        </div>\n        <div class=\"form-group row\">\n          <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n          <div class=\"col-sm-10\">\n            <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"></textarea>\n          </div>\n        </div>\n\n        <div class=\"form-group row\">\n          <div class=\"col-sm-10\">\n            <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</section>"},{"timestamp":458.1,"fileName":"dish-type-list.phtml","content":"<section class=\"ftco-section\"> \n  <div class=\"container\">\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n        \n      </div>\n    </div>\n\n    <div class=\"col-md-12 mb-5 pb-3\">\n      <h3>Új ételtípus létrehozása</h3>\n      <form action=\"/create-dish-type\" method=\"POST\">\n        <div class=\"form-group row\">\n          <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n          <div class=\"col-sm-10\">\n            <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n          </div>\n        </div>\n        <div class=\"form-group row\">\n          <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n          <div class=\"col-sm-10\">\n            <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"></textarea>\n          </div>\n        </div>\n\n        <div class=\"form-group row\">\n          <div class=\"col-sm-10\">\n            <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</section>"},{"timestamp":459.949,"fileName":"dish-type-list.phtml","content":"<section class=\"ftco-section\"> \n  <div class=\"container\">\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n      <?php foreach ($params['dishTypes'] as $dishType) : ?>\n          <div class=\"row mb-4 border-bottom border-dark\">\n            <div class=\"d-flex \">\n              <div class=\"desc pl-3\">\n                <div class=\"d-flex text align-items-center\">\n                  <h3><span><?= $dishType['name'] ?></span></h3>\n                </div>\n              </div>\n            </div>\n          </div>\n        <?php endforeach ?>\n      </div>\n    </div>\n\n    <div class=\"col-md-12 mb-5 pb-3\">\n      <h3>Új ételtípus létrehozása</h3>\n      <form action=\"/create-dish-type\" method=\"POST\">\n        <div class=\"form-group row\">\n          <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n          <div class=\"col-sm-10\">\n            <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n          </div>\n        </div>\n        <div class=\"form-group row\">\n          <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n          <div class=\"col-sm-10\">\n            <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"></textarea>\n          </div>\n        </div>\n\n        <div class=\"form-group row\">\n          <div class=\"col-sm-10\">\n            <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</section>"},{"timestamp":461.3,"fileName":"dish-type-list.phtml","content":"<section class=\"ftco-section\">\n  <div class=\"container\">\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n        <?php foreach ($params['dishTypes'] as $dishType) : ?>\n          <div class=\"row mb-4 border-bottom border-dark\">\n            <div class=\"d-flex \">\n              <div class=\"desc pl-3\">\n                <div class=\"d-flex text align-items-center\">\n                  <h3><span><?= $dishType['name'] ?></span></h3>\n                </div>\n              </div>\n            </div>\n          </div>\n        <?php endforeach ?>\n      </div>\n    </div>\n\n    <div class=\"col-md-12 mb-5 pb-3\">\n      <h3>Új ételtípus létrehozása</h3>\n      <form action=\"/create-dish-type\" method=\"POST\">\n        <div class=\"form-group row\">\n          <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n          <div class=\"col-sm-10\">\n            <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n          </div>\n        </div>\n        <div class=\"form-group row\">\n          <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n          <div class=\"col-sm-10\">\n            <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"></textarea>\n          </div>\n        </div>\n\n        <div class=\"form-group row\">\n          <div class=\"col-sm-10\">\n            <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</section>"},{"timestamp":471.266,"fileName":"dish-type-list.phtml","content":"<section class=\"ftco-section\">\n  <div class=\"container\">\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n        <?php foreach ($params['dishTypes'] as $dishType) : ?>\n          <div class=\"row mb-4 border-bottom border-dark\">\n            <div class=\"d-flex \">\n              <div class=\"desc pl-3\">\n                <div class=\"d-flex text align-items-center\">\n                  <h3><span><?= $dishType['name'] ?></span></h3>\n                </div>\n              </div>\n            </div>\n          </div>\n        <?php endforeach ?>\n      </div>\n    </div>\n\n    <div class=\"col-md-12 mb-5 pb-3\">\n      <h3>Új ételtípus létrehozása</h3>\n      <form action=\"/create-dish-type\" method=\"POST\"> \n        <div class=\"form-group row\">\n          <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n          <div class=\"col-sm-10\">\n            <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n          </div>\n        </div>\n        <div class=\"form-group row\">\n          <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n          <div class=\"col-sm-10\">\n            <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"></textarea>\n          </div>\n        </div>\n\n        <div class=\"form-group row\">\n          <div class=\"col-sm-10\">\n            <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</section>"},{"timestamp":475.666,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":476.216,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    \n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":477.05,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    []\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":477.583,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":478.266,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":478.899,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":479.899,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', ]\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":480.6,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":481.05,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":485.883,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":486.633,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction \n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":487.166,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":487.3,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":487.5,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler() {}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":488.05,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler() {\n    \n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":490.816,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler() {\n    redirectToLoginPageIfNotLoggedIn();\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":491.149,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    \n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":491.533,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n       \n    );\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":492.916,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \n    );\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":494.816,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":496.75,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`)  \n        VALUES \n        (?, ?, ?);\"\n    );\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":498.033,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\" \n    );\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":503.35,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    \n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":504.05,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n\n        ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":505.149,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n\n    ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":507.016,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        \n\n    ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":512.766,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n\n    ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":514.049,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        \n\n    ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":514.633,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n\n    ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":517.033,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":520.333,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    \n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":521.133,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":534.216,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    \n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":534.799,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":536.583,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":537.216,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":539.016,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":539.966,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":596.566,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nreq\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":597.633,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":598.266,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire \n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":599.066,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './'\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":600.049,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php;'\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":600.5,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php'\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":601.1,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":601.399,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishes.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":601.516,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './dishTypes.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":601.649,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":604.016,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler() \n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":607.299,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":609.233,"fileName":"auth.php","content":"<?php"},{"timestamp":609.616,"fileName":"auth.php","content":"<?php\n"},{"timestamp":610.466,"fileName":"auth.php","content":"<?php\n\nfunction logoutHandler() \n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}"},{"timestamp":612.016,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction createDishTypeHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":616.549,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":616.7,"fileName":"dishTypes.php","content":"<"},{"timestamp":616.899,"fileName":"dishTypes.php","content":"<?"},{"timestamp":619.2,"fileName":"dishTypes.php","content":"<?php\n\n"},{"timestamp":619.533,"fileName":"dishTypes.php","content":"<?php\n\nfunction createDishTypeHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}"},{"timestamp":622.266,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":622.583,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":623.049,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":626.2,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":629.566,"fileName":"dishes.php","content":"<?php\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}"},{"timestamp":632.283,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":632.683,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":633.333,"fileName":"dishes.php","content":"<?php\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n"},{"timestamp":633.783,"fileName":"dishes.php","content":"<?php\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n"},{"timestamp":634.7,"fileName":"dishes.php","content":"<?php\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}"},{"timestamp":637.866,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":638.683,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\n\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":640.333,"fileName":"dishes.php","content":"<?php\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}"},{"timestamp":642.049,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\n\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\n\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":643.549,"fileName":"dishes.php","content":"<?php\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}"},{"timestamp":645.866,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n\n\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\n\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":648.016,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\n\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":650.566,"fileName":"auth.php","content":"<?php\n\nfunction logoutHandler() \n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\n"},{"timestamp":650.633,"fileName":"auth.php","content":"<?php\n\nfunction logoutHandler() \n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\n\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}"},{"timestamp":654.083,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\n\n\n\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":654.75,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":655.083,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":657.316,"fileName":"dishTypes.php","content":"<?php\n\nfunction createDishTypeHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}"},{"timestamp":659.933,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"}]