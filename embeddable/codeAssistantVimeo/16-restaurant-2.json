[{"timestamp":0,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":11.3,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":11.8,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    \n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":13.166,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    []\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":13.883000000000001,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":16.866,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":17.4,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', ]\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":17.633,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":18.183,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":18.732999999999997,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":20.366,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":24.933,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":25.4,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nf\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":26.116,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction \n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":26.316,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":26.866,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":27.616,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() {\n    \n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":28.75,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":29.715999999999998,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    \n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":30.4,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":37.166,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    \n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":42.016,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml');\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":43.666,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', );\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":45.15,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        \n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":45.35,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        ''\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":45.933,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content'\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":46.716,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' =>\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":47.033,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => \n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":47.4,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml')\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":58.449,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', )\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":59,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":59.416,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":59.866,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTy'\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":60.315999999999995,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes'\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":61.366,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' =>\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":61.6,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":62.1,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":63.916000000000004,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":67.69900000000001,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":69.55000000000001,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":79.66600000000001,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\n\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":80.283,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfun\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":80.44900000000001,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":80.69900000000001,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction \n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":81.96600000000001,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction get\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":82.71600000000001,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAll\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":83.116,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDish\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":83.38300000000001,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTyp\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":83.94900000000001,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":84.283,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    \n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":86.44900000000001,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":86.983,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":88.58300000000001,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":88.83300000000001,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return \n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":89.65,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return  \n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":90.733,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":91.316,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dis\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":91.38300000000001,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dish\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":91.9,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":92.24900000000001,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":93.866,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":96.74900000000001,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes()\n{\n    $pdo = getConnection(); \n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":100.08300000000001,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes()\n{\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":100.63300000000001,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes()\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":102.41600000000001,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":111.88300000000001,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":114.55000000000001,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":114.933,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":115.266,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes; \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":115.49900000000001,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes(); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":117.066,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":121.783,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":126.183,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":126.83300000000001,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":129.59900000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":133.733,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":136.066,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $dishTypes = getAllDishTypes($pdo); \n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":139.55,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    \n    $dishTypes = getAllDishTypes($pdo); \n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":141.683,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":147.05,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":147.749,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":148.78300000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var_dump()\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":149.983,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var_dump($dishTypes);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":150.20000000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var_dump($dishTypes);\n    \n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":150.55,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var_dump($dishTypes);\n    exit;\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":155.05,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var_dump($dishTypes);\n    exit;\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":155.366,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var_dump($dishTypes);\n    exit;\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":156.433,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    \n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":157.3,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":157.616,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":161.05,"fileName":"create-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\"> \n                            <option value=\"1\">\n                                Levesek </option>\n                            <option value=\"2\">\n                                Főételek </option>\n                            <option value=\"3\">\n                                Desszertek </option>\n                            <option value=\"4\">\n                                Italok </option>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":171.51600000000002,"fileName":"edit-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3><?= $params['dish']['name'] ?></h3>\n            <form action=\"/update-dish/<?= $params['dish']['id'] ?>\" method=\"POST\"> \n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\" value=\"<?= $params['dish']['name'] ?>\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputSlug\" class=\"col-sm-2 col-form-label\">Keresőbarát név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputSlug\" name=\"slug\" value=\"<?= $params['dish']['slug'] ?>\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"><?= $params['dish']['description'] ?></textarea>\n                    </div>\n                </div>\n\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\" value=\"<?= $params['dish']['price'] ?>\">\n                    </div>\n                </div>\n\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?> \n                                <option value=\"<?= $dishType['id'] ?>\" <?= $dishType['id'] === $params['dish']['dishTypeId'] ? \"selected\" : \"\" ?> >\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n\n                        </select>\n                    </div>\n                </div>\n\n                <div class=\"form-group row pb-3\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\" <?= $params['dish']['isActive'] === \"0\" ? \"\" : \"checked\" ?>>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":173.633,"fileName":"create-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n                            <option value=\"1\">\n                                Levesek </option>\n                            <option value=\"2\">\n                                Főételek </option>\n                            <option value=\"3\">\n                                Desszertek </option>\n                            <option value=\"4\">\n                                Italok </option>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":173.999,"fileName":"edit-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3><?= $params['dish']['name'] ?></h3>\n            <form action=\"/update-dish/<?= $params['dish']['id'] ?>\" method=\"POST\"> \n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\" value=\"<?= $params['dish']['name'] ?>\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputSlug\" class=\"col-sm-2 col-form-label\">Keresőbarát név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputSlug\" name=\"slug\" value=\"<?= $params['dish']['slug'] ?>\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"><?= $params['dish']['description'] ?></textarea>\n                    </div>\n                </div>\n\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\" value=\"<?= $params['dish']['price'] ?>\">\n                    </div>\n                </div>\n\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?>  \n                                <option value=\"<?= $dishType['id'] ?>\" <?= $dishType['id'] === $params['dish']['dishTypeId'] ? \"selected\" : \"\" ?> >\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n\n                        </select>\n                    </div>\n                </div>\n\n                <div class=\"form-group row pb-3\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\" <?= $params['dish']['isActive'] === \"0\" ? \"\" : \"checked\" ?>>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":178.616,"fileName":"create-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\"> \n                        <?php foreach ($params['dishTypes'] as $dishType) : ?>  \n                                <option value=\"<?= $dishType['id'] ?>\" <?= $dishType['id'] === $params['dish']['dishTypeId'] ? \"selected\" : \"\" ?> >\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":179.76600000000002,"fileName":"create-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?>\n                                <option value=\"<?= $dishType['id'] ?>\" <?= $dishType['id'] === $params['dish']['dishTypeId'] ? \"selected\" : \"\" ?>>\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":182.416,"fileName":"create-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?>\n                                <option value=\"<?= $dishType['id'] ?>\"  <?= $dishType['id'] === $params['dish']['dishTypeId'] ? \"selected\" : \"\" ?>>\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":185.683,"fileName":"create-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?>\n                                <option value=\"<?= $dishType['id'] ?>\" >\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":186.216,"fileName":"create-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?>\n                                <option value=\"<?= $dishType['id'] ?>\">\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":193.983,"fileName":"create-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\"> \n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?>\n                                <option value=\"<?= $dishType['id'] ?>\">\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":207.866,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":208.333,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    \n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":208.833,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    []\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":209.84900000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":210.733,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":211.633,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', ]\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":211.916,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":212.383,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":213.749,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', ]\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":214.34900000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":215.633,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'create']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":216.366,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDi']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":216.633,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDish']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":217.433,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHan']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":217.65,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":220.05,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":220.3,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfun\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":220.9,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction \n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":221.116,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":221.84900000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":222.26600000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler() \n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":222.866,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler() {\n    \n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":223.616,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":224.45000000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    \n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":228.45000000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":229.316,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    \n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":230.84900000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n\n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":234.583,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":235.716,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (?, ?, ?, ?, ?, ?);\"\n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":237.28300000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`)  \n        VALUES \n        (?, ?, ?, ?, ?, ?);\"\n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":238.583,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (?, ?, ?, ?, ?, ?);\" \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":257.666,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (, ?, ?, ?, ?, ?);\" \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":258.183,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, ?, ?, ?, ?, ?);\" \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":261.933,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, ?, ?, ?, ?);\" \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":263.33299999999997,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, ?, ?, ?);\" \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":263.933,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":266.08299999999997,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \n        ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":267.51599999999996,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":272.4,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"  \n    );\n\n    $stmt->execute([\n       \n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":280.25,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"\"\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":281.233,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"le\"\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":282.4,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"lei\"\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":283.416,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => \n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":285.799,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":288.383,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":288.666,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":289.233,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":289.53299999999996,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":290.58299999999997,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":291.933,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId']\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":293.71599999999995,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":294.299,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":295.416,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"\"\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":296.08299999999997,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\"\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":296.433,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" =\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":296.9,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => \n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":297.366,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => sl\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":297.633,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugi\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":298.01599999999996,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":298.416,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify()\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":300.2,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify(),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":301.683,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":302.03299999999996,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":302.26599999999996,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":302.633,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST[]),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":303.7,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST['']),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":304.383,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST['nam']),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":304.599,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST['name']),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":306.96599999999995,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"nev\" => $_POST['name'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":313.08299999999997,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST['name']),\n        \"nev\" => $_POST['name'],\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":313.75,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":315.7,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":325.416,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    \n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":327.383,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":351.799,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    \n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":353.2,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    []\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":353.4,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":354.099,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":354.233,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":354.666,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delet']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":354.916,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":355.4,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-di']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":355.75,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":356.51599999999996,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{}']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":357.15,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dish}']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":358.683,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishI}']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":359.366,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":361.733,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', ]\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":362.183,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":363.883,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'de']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":364.099,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'delete']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":364.383,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteD']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":364.95,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDish']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":365.65,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":368.65,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction \n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":369.049,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":369.416,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler()\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":369.983,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler()\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":371.166,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($)\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":371.71599999999995,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($u)\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":371.983,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($url)\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":372.71599999999995,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlPar)\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":373.483,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParam)\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":373.7,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":374,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    v\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":374.15,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":375.299,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump()\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":375.483,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":385.416,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    \n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":385.599,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":386.983,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n\n    \n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":388.78299999999996,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    \n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":389.049,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":391.01599999999996,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    \n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":391.299,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":392.183,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    \n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":392.683,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":393.133,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":393.683,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->exec\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":394.65,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute()\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":394.75,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        \n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":397.599,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek\n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":398.616,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek[]\n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":399.183,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['']\n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":399.78299999999996,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dish']\n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":400.233,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishI']\n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":400.71599999999995,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":401.666,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":403.7,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    \n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":404.849,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":405.7,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":407.4,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":408.01599999999996,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":423.25,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":423.9,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    \n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":424.76599999999996,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":425.566,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":425.849,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":426.78299999999996,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', ]\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":428.233,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":428.9,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":430.933,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":431.45,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction \n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":431.849,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":432.299,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":432.599,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler() \n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":433.066,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler() {\n    \n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":434.683,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler() {\n    redirectToLoginPageIfNotLoggedIn();\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":435.51599999999996,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":436.349,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    \n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":437.316,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":440.46599999999995,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    \n\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":441.183,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":443.916,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    \n\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":444.666,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":451.866,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":455.01599999999996,"fileName":"dish-type-list.phtml","content":"<section class=\"ftco-section\"> \n  <div class=\"container\">\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n        <div class=\"row mb-4 border-bottom border-dark\">\n          <div class=\"d-flex\">\n            <div class=\"desc pl-3\">\n              <div class=\"d-flex text align-items-center\">\n                <h3><span>Levesek</span></h3>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"row mb-4 border-bottom border-dark\">\n          <div class=\"d-flex \">\n            <div class=\"desc pl-3\">\n              <div class=\"d-flex text align-items-center\">\n                <h3><span>Főételek</span></h3>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"row mb-4 border-bottom border-dark\">\n          <div class=\"d-flex \">\n            <div class=\"desc pl-3\">\n              <div class=\"d-flex text align-items-center\">\n                <h3><span>Desszertek</span></h3>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"row mb-4 border-bottom border-dark\">\n          <div class=\"d-flex \">\n            <div class=\"desc pl-3\">\n              <div class=\"d-flex text align-items-center\">\n                <h3><span>Italok</span></h3>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"col-md-12 mb-5 pb-3\">\n      <h3>Új ételtípus létrehozása</h3>\n      <form action=\"/create-dish-type\" method=\"POST\">\n        <div class=\"form-group row\">\n          <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n          <div class=\"col-sm-10\">\n            <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n          </div>\n        </div>\n        <div class=\"form-group row\">\n          <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n          <div class=\"col-sm-10\">\n            <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"></textarea>\n          </div>\n        </div>\n\n        <div class=\"form-group row\">\n          <div class=\"col-sm-10\">\n            <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</section>"},{"timestamp":458,"fileName":"dish-type-list.phtml","content":"<section class=\"ftco-section\"> \n  <div class=\"container\">\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n        \n      </div>\n    </div>\n\n    <div class=\"col-md-12 mb-5 pb-3\">\n      <h3>Új ételtípus létrehozása</h3>\n      <form action=\"/create-dish-type\" method=\"POST\">\n        <div class=\"form-group row\">\n          <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n          <div class=\"col-sm-10\">\n            <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n          </div>\n        </div>\n        <div class=\"form-group row\">\n          <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n          <div class=\"col-sm-10\">\n            <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"></textarea>\n          </div>\n        </div>\n\n        <div class=\"form-group row\">\n          <div class=\"col-sm-10\">\n            <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</section>"},{"timestamp":459.849,"fileName":"dish-type-list.phtml","content":"<section class=\"ftco-section\"> \n  <div class=\"container\">\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n      <?php foreach ($params['dishTypes'] as $dishType) : ?>\n          <div class=\"row mb-4 border-bottom border-dark\">\n            <div class=\"d-flex \">\n              <div class=\"desc pl-3\">\n                <div class=\"d-flex text align-items-center\">\n                  <h3><span><?= $dishType['name'] ?></span></h3>\n                </div>\n              </div>\n            </div>\n          </div>\n        <?php endforeach ?>\n      </div>\n    </div>\n\n    <div class=\"col-md-12 mb-5 pb-3\">\n      <h3>Új ételtípus létrehozása</h3>\n      <form action=\"/create-dish-type\" method=\"POST\">\n        <div class=\"form-group row\">\n          <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n          <div class=\"col-sm-10\">\n            <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n          </div>\n        </div>\n        <div class=\"form-group row\">\n          <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n          <div class=\"col-sm-10\">\n            <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"></textarea>\n          </div>\n        </div>\n\n        <div class=\"form-group row\">\n          <div class=\"col-sm-10\">\n            <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</section>"},{"timestamp":461.2,"fileName":"dish-type-list.phtml","content":"<section class=\"ftco-section\">\n  <div class=\"container\">\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n        <?php foreach ($params['dishTypes'] as $dishType) : ?>\n          <div class=\"row mb-4 border-bottom border-dark\">\n            <div class=\"d-flex \">\n              <div class=\"desc pl-3\">\n                <div class=\"d-flex text align-items-center\">\n                  <h3><span><?= $dishType['name'] ?></span></h3>\n                </div>\n              </div>\n            </div>\n          </div>\n        <?php endforeach ?>\n      </div>\n    </div>\n\n    <div class=\"col-md-12 mb-5 pb-3\">\n      <h3>Új ételtípus létrehozása</h3>\n      <form action=\"/create-dish-type\" method=\"POST\">\n        <div class=\"form-group row\">\n          <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n          <div class=\"col-sm-10\">\n            <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n          </div>\n        </div>\n        <div class=\"form-group row\">\n          <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n          <div class=\"col-sm-10\">\n            <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"></textarea>\n          </div>\n        </div>\n\n        <div class=\"form-group row\">\n          <div class=\"col-sm-10\">\n            <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</section>"},{"timestamp":471.166,"fileName":"dish-type-list.phtml","content":"<section class=\"ftco-section\">\n  <div class=\"container\">\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n        <?php foreach ($params['dishTypes'] as $dishType) : ?>\n          <div class=\"row mb-4 border-bottom border-dark\">\n            <div class=\"d-flex \">\n              <div class=\"desc pl-3\">\n                <div class=\"d-flex text align-items-center\">\n                  <h3><span><?= $dishType['name'] ?></span></h3>\n                </div>\n              </div>\n            </div>\n          </div>\n        <?php endforeach ?>\n      </div>\n    </div>\n\n    <div class=\"col-md-12 mb-5 pb-3\">\n      <h3>Új ételtípus létrehozása</h3>\n      <form action=\"/create-dish-type\" method=\"POST\"> \n        <div class=\"form-group row\">\n          <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n          <div class=\"col-sm-10\">\n            <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n          </div>\n        </div>\n        <div class=\"form-group row\">\n          <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n          <div class=\"col-sm-10\">\n            <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"></textarea>\n          </div>\n        </div>\n\n        <div class=\"form-group row\">\n          <div class=\"col-sm-10\">\n            <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</section>"},{"timestamp":475.566,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":476.116,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    \n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":476.95,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    []\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":477.483,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":478.166,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":478.799,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":479.799,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', ]\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":480.5,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":480.95,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":485.78299999999996,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":486.53299999999996,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction \n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":487.066,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":487.2,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":487.4,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler() {}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":487.95,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler() {\n    \n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":490.71599999999995,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler() {\n    redirectToLoginPageIfNotLoggedIn();\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":491.049,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    \n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":491.433,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n       \n    );\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":492.816,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \n    );\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":494.71599999999995,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":496.65,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`)  \n        VALUES \n        (?, ?, ?);\"\n    );\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":497.933,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\" \n    );\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":503.25,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    \n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":503.95,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n\n        ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":505.049,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n\n    ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":506.916,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        \n\n    ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":512.6659999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n\n    ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":513.949,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        \n\n    ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":514.533,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n\n    ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":516.933,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":520.233,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    \n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":521.033,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":534.116,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    \n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":534.699,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":536.483,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":537.116,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":538.9159999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":539.866,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":596.466,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nreq\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":597.533,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":598.1659999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire \n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":598.966,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './'\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":599.949,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php;'\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":600.4,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php'\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":601,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":601.299,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishes.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":601.4159999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './dishTypes.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":601.549,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":603.9159999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler() \n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":607.199,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":609.1329999999999,"fileName":"auth.php","content":"<?php"},{"timestamp":609.516,"fileName":"auth.php","content":"<?php\n"},{"timestamp":610.366,"fileName":"auth.php","content":"<?php\n\nfunction logoutHandler() \n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}"},{"timestamp":611.9159999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction createDishTypeHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":616.449,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":616.6,"fileName":"dishTypes.php","content":"<"},{"timestamp":616.799,"fileName":"dishTypes.php","content":"<?"},{"timestamp":619.1,"fileName":"dishTypes.php","content":"<?php\n\n"},{"timestamp":619.433,"fileName":"dishTypes.php","content":"<?php\n\nfunction createDishTypeHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}"},{"timestamp":622.1659999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":622.483,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":622.949,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":626.1,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":629.466,"fileName":"dishes.php","content":"<?php\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}"},{"timestamp":632.183,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":632.583,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":633.233,"fileName":"dishes.php","content":"<?php\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n"},{"timestamp":633.683,"fileName":"dishes.php","content":"<?php\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n"},{"timestamp":634.6,"fileName":"dishes.php","content":"<?php\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}"},{"timestamp":637.766,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":638.583,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\n\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":640.233,"fileName":"dishes.php","content":"<?php\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}"},{"timestamp":641.949,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\n\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\n\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":643.449,"fileName":"dishes.php","content":"<?php\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}"},{"timestamp":645.766,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n\n\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\n\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":647.9159999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\n\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":650.466,"fileName":"auth.php","content":"<?php\n\nfunction logoutHandler() \n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\n"},{"timestamp":650.533,"fileName":"auth.php","content":"<?php\n\nfunction logoutHandler() \n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\n\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}"},{"timestamp":653.983,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\n\n\n\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":654.65,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":654.983,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":657.216,"fileName":"dishTypes.php","content":"<?php\n\nfunction createDishTypeHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}"},{"timestamp":659.833,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"}]