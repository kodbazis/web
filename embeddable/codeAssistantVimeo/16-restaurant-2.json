[{"timestamp":0,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":11.200000000000001,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":11.700000000000001,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    \n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":13.066,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    []\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":13.783000000000001,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":16.766000000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":17.3,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', ]\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":17.533,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":18.083000000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":18.633,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":20.266000000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":24.833000000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":25.3,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nf\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":26.016000000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction \n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":26.216,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":26.766000000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":27.516000000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() {\n    \n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":28.650000000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":29.616,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    \n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":30.3,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":37.065999999999995,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    \n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":41.916,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml');\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":43.565999999999995,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', );\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":45.05,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        \n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":45.25,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        ''\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":45.833,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content'\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":46.616,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' =>\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":46.933,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => \n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":47.3,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml')\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":58.349,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', )\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":58.9,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":59.315999999999995,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":59.766,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTy'\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":60.215999999999994,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes'\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":61.266,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' =>\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":61.5,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":62,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":63.816,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":67.599,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":69.45,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":79.566,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\n\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":80.18299999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfun\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":80.349,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":80.599,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction \n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":81.866,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction get\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":82.616,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAll\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":83.01599999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDish\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":83.283,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTyp\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":83.849,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":84.18299999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    \n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":86.349,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":86.883,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":88.483,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":88.733,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return \n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":89.55,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return  \n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":90.633,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":91.216,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dis\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":91.283,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dish\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":91.8,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":92.149,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":93.76599999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":96.649,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes()\n{\n    $pdo = getConnection(); \n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":99.983,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes()\n{\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":100.533,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes()\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":102.316,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":111.783,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":114.45,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":114.833,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":115.166,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes; \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":115.399,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes(); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":116.966,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":121.68299999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":126.083,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":126.733,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":129.49900000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":133.633,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":135.966,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $dishTypes = getAllDishTypes($pdo); \n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":139.45000000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    \n    $dishTypes = getAllDishTypes($pdo); \n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":141.583,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":146.95000000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":147.649,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":148.68300000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var_dump()\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":149.883,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var_dump($dishTypes);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":150.10000000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var_dump($dishTypes);\n    \n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":150.45000000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var_dump($dishTypes);\n    exit;\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":154.95000000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var_dump($dishTypes);\n    exit;\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":155.26600000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var_dump($dishTypes);\n    exit;\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":156.333,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    \n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":157.20000000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":157.51600000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":160.95000000000002,"fileName":"create-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\"> \n                            <option value=\"1\">\n                                Levesek </option>\n                            <option value=\"2\">\n                                Főételek </option>\n                            <option value=\"3\">\n                                Desszertek </option>\n                            <option value=\"4\">\n                                Italok </option>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":171.41600000000003,"fileName":"edit-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3><?= $params['dish']['name'] ?></h3>\n            <form action=\"/update-dish/<?= $params['dish']['id'] ?>\" method=\"POST\"> \n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\" value=\"<?= $params['dish']['name'] ?>\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputSlug\" class=\"col-sm-2 col-form-label\">Keresőbarát név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputSlug\" name=\"slug\" value=\"<?= $params['dish']['slug'] ?>\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"><?= $params['dish']['description'] ?></textarea>\n                    </div>\n                </div>\n\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\" value=\"<?= $params['dish']['price'] ?>\">\n                    </div>\n                </div>\n\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?> \n                                <option value=\"<?= $dishType['id'] ?>\" <?= $dishType['id'] === $params['dish']['dishTypeId'] ? \"selected\" : \"\" ?> >\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n\n                        </select>\n                    </div>\n                </div>\n\n                <div class=\"form-group row pb-3\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\" <?= $params['dish']['isActive'] === \"0\" ? \"\" : \"checked\" ?>>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":173.53300000000002,"fileName":"create-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n                            <option value=\"1\">\n                                Levesek </option>\n                            <option value=\"2\">\n                                Főételek </option>\n                            <option value=\"3\">\n                                Desszertek </option>\n                            <option value=\"4\">\n                                Italok </option>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":173.899,"fileName":"edit-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3><?= $params['dish']['name'] ?></h3>\n            <form action=\"/update-dish/<?= $params['dish']['id'] ?>\" method=\"POST\"> \n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\" value=\"<?= $params['dish']['name'] ?>\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputSlug\" class=\"col-sm-2 col-form-label\">Keresőbarát név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputSlug\" name=\"slug\" value=\"<?= $params['dish']['slug'] ?>\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"><?= $params['dish']['description'] ?></textarea>\n                    </div>\n                </div>\n\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\" value=\"<?= $params['dish']['price'] ?>\">\n                    </div>\n                </div>\n\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?>  \n                                <option value=\"<?= $dishType['id'] ?>\" <?= $dishType['id'] === $params['dish']['dishTypeId'] ? \"selected\" : \"\" ?> >\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n\n                        </select>\n                    </div>\n                </div>\n\n                <div class=\"form-group row pb-3\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\" <?= $params['dish']['isActive'] === \"0\" ? \"\" : \"checked\" ?>>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":178.51600000000002,"fileName":"create-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\"> \n                        <?php foreach ($params['dishTypes'] as $dishType) : ?>  \n                                <option value=\"<?= $dishType['id'] ?>\" <?= $dishType['id'] === $params['dish']['dishTypeId'] ? \"selected\" : \"\" ?> >\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":179.66600000000003,"fileName":"create-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?>\n                                <option value=\"<?= $dishType['id'] ?>\" <?= $dishType['id'] === $params['dish']['dishTypeId'] ? \"selected\" : \"\" ?>>\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":182.316,"fileName":"create-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?>\n                                <option value=\"<?= $dishType['id'] ?>\"  <?= $dishType['id'] === $params['dish']['dishTypeId'] ? \"selected\" : \"\" ?>>\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":185.583,"fileName":"create-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?>\n                                <option value=\"<?= $dishType['id'] ?>\" >\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":186.116,"fileName":"create-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?>\n                                <option value=\"<?= $dishType['id'] ?>\">\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":193.883,"fileName":"create-dish.phtml","content":"<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\"> \n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?>\n                                <option value=\"<?= $dishType['id'] ?>\">\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"},{"timestamp":207.76600000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":208.233,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    \n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":208.733,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    []\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":209.74900000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":210.633,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":211.53300000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', ]\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":211.816,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":212.28300000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":213.649,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', ]\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":214.24900000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":215.53300000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'create']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":216.26600000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDi']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":216.53300000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDish']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":217.333,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHan']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":217.55,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":219.95000000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":220.20000000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfun\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":220.8,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction \n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":221.01600000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":221.74900000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":222.16600000000003,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler() \n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":222.76600000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler() {\n    \n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":223.51600000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":224.35000000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    \n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":228.35000000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":229.216,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    \n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":230.74900000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n\n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":234.483,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":235.616,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (?, ?, ?, ?, ?, ?);\"\n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":237.18300000000002,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`)  \n        VALUES \n        (?, ?, ?, ?, ?, ?);\"\n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":238.483,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (?, ?, ?, ?, ?, ?);\" \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":257.56600000000003,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (, ?, ?, ?, ?, ?);\" \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":258.083,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, ?, ?, ?, ?, ?);\" \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":261.833,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, ?, ?, ?, ?);\" \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":263.233,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, ?, ?, ?);\" \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":263.833,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":265.983,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \n        ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":267.416,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":272.3,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"  \n    );\n\n    $stmt->execute([\n       \n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":280.15000000000003,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"\"\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":281.13300000000004,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"le\"\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":282.3,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"lei\"\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":283.31600000000003,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => \n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":285.699,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":288.283,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":288.56600000000003,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":289.13300000000004,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":289.433,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":290.483,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":291.833,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId']\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":293.616,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":294.199,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":295.31600000000003,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"\"\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":295.983,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\"\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":296.333,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" =\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":296.8,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => \n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":297.266,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => sl\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":297.533,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugi\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":297.916,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":298.31600000000003,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify()\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":300.1,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify(),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":301.583,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":301.933,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":302.166,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":302.533,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST[]),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":303.6,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST['']),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":304.283,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST['nam']),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":304.499,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST['name']),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":306.866,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"nev\" => $_POST['name'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":312.983,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST['name']),\n        \"nev\" => $_POST['name'],\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":313.65000000000003,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":315.6,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":325.31600000000003,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    \n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":327.283,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":351.699,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    \n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":353.1,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    []\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":353.3,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":353.999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":354.13300000000004,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":354.56600000000003,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delet']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":354.81600000000003,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":355.3,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-di']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":355.65000000000003,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":356.416,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{}']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":357.05,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dish}']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":358.583,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishI}']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":359.266,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":361.63300000000004,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', ]\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":362.083,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":363.783,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'de']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":363.999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'delete']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":364.283,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteD']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":364.85,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDish']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":365.55,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":368.55,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction \n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":368.949,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":369.31600000000003,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler()\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":369.88300000000004,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler()\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":371.06600000000003,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($)\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":371.616,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($u)\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":371.88300000000004,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($url)\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":372.616,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlPar)\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":373.38300000000004,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParam)\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":373.6,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":373.90000000000003,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    v\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":374.05,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":375.199,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump()\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":375.38300000000004,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":385.31600000000003,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    \n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":385.499,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":386.88300000000004,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n\n    \n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":388.683,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    \n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":388.949,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":390.916,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    \n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":391.199,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":392.083,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    \n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":392.583,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":393.033,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":393.583,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->exec\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":394.55,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute()\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":394.65000000000003,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        \n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":397.499,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek\n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":398.516,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek[]\n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":399.083,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['']\n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":399.683,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dish']\n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":400.13300000000004,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishI']\n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":400.616,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":401.56600000000003,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":403.6,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    \n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":404.749,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":405.6,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":407.3,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":407.916,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":423.15000000000003,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":423.8,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    \n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":424.666,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":425.466,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":425.749,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":426.683,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', ]\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":428.13300000000004,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":428.8,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":430.833,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":431.35,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction \n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":431.749,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":432.199,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":432.499,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler() \n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":432.966,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler() {\n    \n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":434.583,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler() {\n    redirectToLoginPageIfNotLoggedIn();\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":435.416,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":436.249,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    \n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":437.216,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":440.366,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    \n\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":441.083,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":443.81600000000003,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    \n\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":444.56600000000003,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":451.766,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":454.916,"fileName":"dish-type-list.phtml","content":"<section class=\"ftco-section\"> \n  <div class=\"container\">\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n        <div class=\"row mb-4 border-bottom border-dark\">\n          <div class=\"d-flex\">\n            <div class=\"desc pl-3\">\n              <div class=\"d-flex text align-items-center\">\n                <h3><span>Levesek</span></h3>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"row mb-4 border-bottom border-dark\">\n          <div class=\"d-flex \">\n            <div class=\"desc pl-3\">\n              <div class=\"d-flex text align-items-center\">\n                <h3><span>Főételek</span></h3>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"row mb-4 border-bottom border-dark\">\n          <div class=\"d-flex \">\n            <div class=\"desc pl-3\">\n              <div class=\"d-flex text align-items-center\">\n                <h3><span>Desszertek</span></h3>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"row mb-4 border-bottom border-dark\">\n          <div class=\"d-flex \">\n            <div class=\"desc pl-3\">\n              <div class=\"d-flex text align-items-center\">\n                <h3><span>Italok</span></h3>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"col-md-12 mb-5 pb-3\">\n      <h3>Új ételtípus létrehozása</h3>\n      <form action=\"/create-dish-type\" method=\"POST\">\n        <div class=\"form-group row\">\n          <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n          <div class=\"col-sm-10\">\n            <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n          </div>\n        </div>\n        <div class=\"form-group row\">\n          <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n          <div class=\"col-sm-10\">\n            <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"></textarea>\n          </div>\n        </div>\n\n        <div class=\"form-group row\">\n          <div class=\"col-sm-10\">\n            <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</section>"},{"timestamp":457.90000000000003,"fileName":"dish-type-list.phtml","content":"<section class=\"ftco-section\"> \n  <div class=\"container\">\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n        \n      </div>\n    </div>\n\n    <div class=\"col-md-12 mb-5 pb-3\">\n      <h3>Új ételtípus létrehozása</h3>\n      <form action=\"/create-dish-type\" method=\"POST\">\n        <div class=\"form-group row\">\n          <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n          <div class=\"col-sm-10\">\n            <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n          </div>\n        </div>\n        <div class=\"form-group row\">\n          <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n          <div class=\"col-sm-10\">\n            <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"></textarea>\n          </div>\n        </div>\n\n        <div class=\"form-group row\">\n          <div class=\"col-sm-10\">\n            <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</section>"},{"timestamp":459.749,"fileName":"dish-type-list.phtml","content":"<section class=\"ftco-section\"> \n  <div class=\"container\">\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n      <?php foreach ($params['dishTypes'] as $dishType) : ?>\n          <div class=\"row mb-4 border-bottom border-dark\">\n            <div class=\"d-flex \">\n              <div class=\"desc pl-3\">\n                <div class=\"d-flex text align-items-center\">\n                  <h3><span><?= $dishType['name'] ?></span></h3>\n                </div>\n              </div>\n            </div>\n          </div>\n        <?php endforeach ?>\n      </div>\n    </div>\n\n    <div class=\"col-md-12 mb-5 pb-3\">\n      <h3>Új ételtípus létrehozása</h3>\n      <form action=\"/create-dish-type\" method=\"POST\">\n        <div class=\"form-group row\">\n          <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n          <div class=\"col-sm-10\">\n            <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n          </div>\n        </div>\n        <div class=\"form-group row\">\n          <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n          <div class=\"col-sm-10\">\n            <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"></textarea>\n          </div>\n        </div>\n\n        <div class=\"form-group row\">\n          <div class=\"col-sm-10\">\n            <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</section>"},{"timestamp":461.1,"fileName":"dish-type-list.phtml","content":"<section class=\"ftco-section\">\n  <div class=\"container\">\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n        <?php foreach ($params['dishTypes'] as $dishType) : ?>\n          <div class=\"row mb-4 border-bottom border-dark\">\n            <div class=\"d-flex \">\n              <div class=\"desc pl-3\">\n                <div class=\"d-flex text align-items-center\">\n                  <h3><span><?= $dishType['name'] ?></span></h3>\n                </div>\n              </div>\n            </div>\n          </div>\n        <?php endforeach ?>\n      </div>\n    </div>\n\n    <div class=\"col-md-12 mb-5 pb-3\">\n      <h3>Új ételtípus létrehozása</h3>\n      <form action=\"/create-dish-type\" method=\"POST\">\n        <div class=\"form-group row\">\n          <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n          <div class=\"col-sm-10\">\n            <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n          </div>\n        </div>\n        <div class=\"form-group row\">\n          <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n          <div class=\"col-sm-10\">\n            <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"></textarea>\n          </div>\n        </div>\n\n        <div class=\"form-group row\">\n          <div class=\"col-sm-10\">\n            <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</section>"},{"timestamp":471.06600000000003,"fileName":"dish-type-list.phtml","content":"<section class=\"ftco-section\">\n  <div class=\"container\">\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n        <?php foreach ($params['dishTypes'] as $dishType) : ?>\n          <div class=\"row mb-4 border-bottom border-dark\">\n            <div class=\"d-flex \">\n              <div class=\"desc pl-3\">\n                <div class=\"d-flex text align-items-center\">\n                  <h3><span><?= $dishType['name'] ?></span></h3>\n                </div>\n              </div>\n            </div>\n          </div>\n        <?php endforeach ?>\n      </div>\n    </div>\n\n    <div class=\"col-md-12 mb-5 pb-3\">\n      <h3>Új ételtípus létrehozása</h3>\n      <form action=\"/create-dish-type\" method=\"POST\"> \n        <div class=\"form-group row\">\n          <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n          <div class=\"col-sm-10\">\n            <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n          </div>\n        </div>\n        <div class=\"form-group row\">\n          <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n          <div class=\"col-sm-10\">\n            <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"></textarea>\n          </div>\n        </div>\n\n        <div class=\"form-group row\">\n          <div class=\"col-sm-10\">\n            <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</section>"},{"timestamp":475.466,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":476.016,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    \n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":476.85,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    []\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":477.38300000000004,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":478.06600000000003,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":478.699,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":479.699,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', ]\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":480.40000000000003,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":480.85,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":485.683,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":486.433,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction \n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":486.966,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":487.1,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":487.3,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler() {}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":487.85,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler() {\n    \n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":490.616,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler() {\n    redirectToLoginPageIfNotLoggedIn();\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":490.949,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    \n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":491.333,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n       \n    );\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":492.716,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \n    );\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":494.616,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":496.55,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`)  \n        VALUES \n        (?, ?, ?);\"\n    );\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":497.833,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\" \n    );\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":503.15000000000003,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    \n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":503.85,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n\n        ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":504.949,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n\n    ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":506.81600000000003,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        \n\n    ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":512.5659999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n\n    ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":513.8489999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        \n\n    ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":514.433,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n\n    ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":516.833,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":520.1329999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    \n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":520.933,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":534.016,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    \n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":534.5989999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":536.3829999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":537.016,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":538.8159999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":539.766,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":596.366,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nreq\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":597.433,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":598.0659999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire \n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":598.866,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './'\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":599.8489999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php;'\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":600.3,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php'\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":600.9,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":601.199,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishes.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":601.3159999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './dishTypes.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":601.449,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":603.8159999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler() \n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":607.0989999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":609.0329999999999,"fileName":"auth.php","content":"<?php"},{"timestamp":609.4159999999999,"fileName":"auth.php","content":"<?php\n"},{"timestamp":610.266,"fileName":"auth.php","content":"<?php\n\nfunction logoutHandler() \n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}"},{"timestamp":611.8159999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction createDishTypeHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":616.3489999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":616.5,"fileName":"dishTypes.php","content":"<"},{"timestamp":616.699,"fileName":"dishTypes.php","content":"<?"},{"timestamp":619,"fileName":"dishTypes.php","content":"<?php\n\n"},{"timestamp":619.333,"fileName":"dishTypes.php","content":"<?php\n\nfunction createDishTypeHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}"},{"timestamp":622.0659999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":622.3829999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":622.8489999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":626,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":629.366,"fileName":"dishes.php","content":"<?php\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}"},{"timestamp":632.083,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":632.483,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":633.1329999999999,"fileName":"dishes.php","content":"<?php\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n"},{"timestamp":633.583,"fileName":"dishes.php","content":"<?php\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n"},{"timestamp":634.5,"fileName":"dishes.php","content":"<?php\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}"},{"timestamp":637.6659999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":638.483,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\n\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":640.1329999999999,"fileName":"dishes.php","content":"<?php\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}"},{"timestamp":641.8489999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\n\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\n\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":643.3489999999999,"fileName":"dishes.php","content":"<?php\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}"},{"timestamp":645.6659999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n\n\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\n\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":647.8159999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\n\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":650.366,"fileName":"auth.php","content":"<?php\n\nfunction logoutHandler() \n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\n"},{"timestamp":650.433,"fileName":"auth.php","content":"<?php\n\nfunction logoutHandler() \n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\n\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}"},{"timestamp":653.8829999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\n\n\n\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":654.55,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":654.8829999999999,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"},{"timestamp":657.116,"fileName":"dishTypes.php","content":"<?php\n\nfunction createDishTypeHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}"},{"timestamp":659.733,"fileName":"index.php","content":"<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"}]