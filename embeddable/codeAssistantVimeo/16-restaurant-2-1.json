[
  {
    "timestamp": 0,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 11.1,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 11.6,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    \n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 12.966,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    []\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 13.683,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 16.666,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 17.2,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', ]\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 17.433,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 17.983,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 18.532999999999998,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 20.166,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 24.733,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\n\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 25.2,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nf\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 25.916,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction \n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 26.116,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 26.666,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 27.416,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() {\n    \n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if(isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams) {\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if(!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n    \n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars) \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 28.55,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 29.516,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    \n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 30.2,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 36.966,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    \n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 41.816,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml');\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 43.466,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', );\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 44.95,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        \n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 45.150000000000006,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        ''\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 45.733000000000004,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content'\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 46.516000000000005,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' =>\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 46.833000000000006,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => \n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 47.2,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml')\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 58.249,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', )\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 58.800000000000004,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 59.216,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 59.666000000000004,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTy'\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 60.116,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes'\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 61.166000000000004,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' =>\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 61.400000000000006,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 61.900000000000006,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 63.71600000000001,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 67.49900000000001,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 69.35000000000001,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 79.46600000000001,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\n\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 80.083,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfun\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 80.24900000000001,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 80.49900000000001,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction \n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 81.766,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction get\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 82.516,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAll\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 82.916,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDish\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 83.183,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTyp\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 83.74900000000001,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 84.083,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    \n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 86.24900000000001,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 86.783,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 88.38300000000001,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 88.63300000000001,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return \n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 89.45,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return  \n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 90.533,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 91.116,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dis\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 91.183,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dish\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 91.7,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 92.049,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [] \n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes'); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes() {\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\"); \n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 93.666,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 96.549,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes()\n{\n    $pdo = getConnection(); \n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 99.88300000000001,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes()\n{\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 100.433,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes()\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 102.21600000000001,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 111.683,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 114.35000000000001,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 114.733,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 115.066,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes; \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 115.299,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes(); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 116.866,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 121.583,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM dishTypes');\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 125.983,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 126.63300000000001,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 129.399,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 133.533,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 135.86599999999999,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $dishTypes = getAllDishTypes($pdo); \n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 139.35,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    \n    $dishTypes = getAllDishTypes($pdo); \n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 141.48299999999998,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 146.85,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 147.54899999999998,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 148.583,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var_dump()\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 149.783,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var_dump($dishTypes);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 150,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var_dump($dishTypes);\n    \n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 150.35,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var_dump($dishTypes);\n    exit;\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => []\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 154.85,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var_dump($dishTypes);\n    exit;\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => [\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 155.166,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    var_dump($dishTypes);\n    exit;\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 156.23299999999998,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    \n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 157.1,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 157.416,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 160.85,
    "fileName": "create-dish.phtml",
    "content": "<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\"> \n                            <option value=\"1\">\n                                Levesek </option>\n                            <option value=\"2\">\n                                Főételek </option>\n                            <option value=\"3\">\n                                Desszertek </option>\n                            <option value=\"4\">\n                                Italok </option>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"
  },
  {
    "timestamp": 171.316,
    "fileName": "edit-dish.phtml",
    "content": "<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3><?= $params['dish']['name'] ?></h3>\n            <form action=\"/update-dish/<?= $params['dish']['id'] ?>\" method=\"POST\"> \n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\" value=\"<?= $params['dish']['name'] ?>\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputSlug\" class=\"col-sm-2 col-form-label\">Keresőbarát név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputSlug\" name=\"slug\" value=\"<?= $params['dish']['slug'] ?>\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"><?= $params['dish']['description'] ?></textarea>\n                    </div>\n                </div>\n\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\" value=\"<?= $params['dish']['price'] ?>\">\n                    </div>\n                </div>\n\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?> \n                                <option value=\"<?= $dishType['id'] ?>\" <?= $dishType['id'] === $params['dish']['dishTypeId'] ? \"selected\" : \"\" ?> >\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n\n                        </select>\n                    </div>\n                </div>\n\n                <div class=\"form-group row pb-3\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\" <?= $params['dish']['isActive'] === \"0\" ? \"\" : \"checked\" ?>>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"
  },
  {
    "timestamp": 173.79899999999998,
    "fileName": "edit-dish.phtml",
    "content": "<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3><?= $params['dish']['name'] ?></h3>\n            <form action=\"/update-dish/<?= $params['dish']['id'] ?>\" method=\"POST\"> \n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\" value=\"<?= $params['dish']['name'] ?>\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputSlug\" class=\"col-sm-2 col-form-label\">Keresőbarát név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputSlug\" name=\"slug\" value=\"<?= $params['dish']['slug'] ?>\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"><?= $params['dish']['description'] ?></textarea>\n                    </div>\n                </div>\n\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\" value=\"<?= $params['dish']['price'] ?>\">\n                    </div>\n                </div>\n\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?>  \n                                <option value=\"<?= $dishType['id'] ?>\" <?= $dishType['id'] === $params['dish']['dishTypeId'] ? \"selected\" : \"\" ?> >\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n\n                        </select>\n                    </div>\n                </div>\n\n                <div class=\"form-group row pb-3\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\" <?= $params['dish']['isActive'] === \"0\" ? \"\" : \"checked\" ?>>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"
  },
  {
    "timestamp": 178.416,
    "fileName": "create-dish.phtml",
    "content": "<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\"> \n                        <?php foreach ($params['dishTypes'] as $dishType) : ?>  \n                                <option value=\"<?= $dishType['id'] ?>\" <?= $dishType['id'] === $params['dish']['dishTypeId'] ? \"selected\" : \"\" ?> >\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"
  },
  {
    "timestamp": 179.566,
    "fileName": "create-dish.phtml",
    "content": "<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?>\n                                <option value=\"<?= $dishType['id'] ?>\" <?= $dishType['id'] === $params['dish']['dishTypeId'] ? \"selected\" : \"\" ?>>\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"
  },
  {
    "timestamp": 182.21599999999998,
    "fileName": "create-dish.phtml",
    "content": "<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?>\n                                <option value=\"<?= $dishType['id'] ?>\"  <?= $dishType['id'] === $params['dish']['dishTypeId'] ? \"selected\" : \"\" ?>>\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"
  },
  {
    "timestamp": 185.48299999999998,
    "fileName": "create-dish.phtml",
    "content": "<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?>\n                                <option value=\"<?= $dishType['id'] ?>\" >\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"
  },
  {
    "timestamp": 186.016,
    "fileName": "create-dish.phtml",
    "content": "<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\">\n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?>\n                                <option value=\"<?= $dishType['id'] ?>\">\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"
  },
  {
    "timestamp": 193.783,
    "fileName": "create-dish.phtml",
    "content": "<section class=\"ftco-section pt-3\">\n    <div class=\"container\">\n        <div class=\"col-md-12 mb-5 pb-3\">\n            <h3>Új étel</h3>\n            <form action=\"/create-dish\" method=\"POST\"> \n                <div class=\"form-group row\">\n                    <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n                    <div class=\"col-sm-10\">\n                        <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" name=\"description\" rows=\"3\"></textarea>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputPrice\" class=\"col-sm-2 col-form-label\">Ár</label>\n                    <div class=\"col-sm-10\">\n                        <input type=\"number\" class=\"form-control\" id=\"inputPrice\" name=\"price\">\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <label for=\"inputType\" class=\"col-sm-2 col-form-label\">Típus</label>\n                    <div class=\"col-sm-10\">\n                        <select name=\"dishTypeId\" id=\"inputType\" class=\"form-control\">\n                            <?php foreach ($params['dishTypes'] as $dishType) : ?>\n                                <option value=\"<?= $dishType['id'] ?>\">\n                                    <?= $dishType['name'] ?>\n                                </option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-2\">Aktív</div>\n                    <div class=\"col-sm-10\">\n                        <div class=\"form-check\">\n                            <input class=\"form-check-input\" type=\"checkbox\" id=\"gridCheck1\" name=\"isActive\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"form-group row\">\n                    <div class=\"col-sm-10\">\n                        <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</section>"
  },
  {
    "timestamp": 207.666,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 208.13299999999998,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    \n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 208.63299999999998,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    []\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 209.649,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 210.533,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 211.433,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', ]\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 211.71599999999998,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 212.183,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 213.54899999999998,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', ]\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 214.149,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 215.433,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'create']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 216.166,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDi']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 216.433,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDish']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 217.23299999999998,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHan']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 217.45,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 219.85,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 220.1,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfun\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 220.7,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction \n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 220.916,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 221.649,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 222.066,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler() \n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 222.666,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler() {\n    \n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo); \n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo); \n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 223.416,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 224.25,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    \n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 228.25,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 229.11599999999999,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    \n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 230.649,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n\n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 234.38299999999998,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 235.516,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (?, ?, ?, ?, ?, ?);\"\n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 237.083,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`)  \n        VALUES \n        (?, ?, ?, ?, ?, ?);\"\n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 238.38299999999998,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (?, ?, ?, ?, ?, ?);\" \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 257.466,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (, ?, ?, ?, ?, ?);\" \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 257.983,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, ?, ?, ?, ?, ?);\" \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 261.733,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, ?, ?, ?, ?);\" \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 263.133,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, ?, ?, ?);\" \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 263.733,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 265.883,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \n        ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 267.316,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 272.2,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"  \n    );\n\n    $stmt->execute([\n       \n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 280.05,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"\"\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 281.033,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"le\"\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 282.2,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"lei\"\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 283.216,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => \n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 285.599,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 288.183,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 288.466,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 289.033,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 289.33299999999997,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 290.383,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 291.733,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId']\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 293.51599999999996,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 294.099,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 295.216,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"\"\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 295.883,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\"\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 296.233,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" =\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 296.7,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => \n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 297.166,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => sl\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 297.433,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugi\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 297.816,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 298.216,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify()\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 300,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify(),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 301.483,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 301.83299999999997,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 302.066,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 302.433,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST[]),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 303.5,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST['']),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 304.183,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST['nam']),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 304.399,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST['name']),\n       \"leiras\" => $_POST['description'],\n       \"nev\" => $_POST['name'],\n       \"ar\" =>  $_POST['price'],\n       \"aktiv\" =>  (int)isset($_POST['isActive']),\n       \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 306.76599999999996,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"nev\" => $_POST['name'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 312.883,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"slug\" => slugify($_POST['name']),\n        \"nev\" => $_POST['name'],\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 313.55,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 315.5,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 325.216,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    \n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 327.183,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 351.599,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    \n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 353,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    []\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 353.2,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 353.899,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 354.033,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 354.466,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delet']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 354.716,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 355.2,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-di']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 355.55,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 356.316,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{}']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 356.95,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dish}']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 358.483,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishI}']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 359.166,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 361.533,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', ]\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 361.983,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 363.683,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'de']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 363.899,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'delete']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 364.183,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteD']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 364.75,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDish']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 365.45,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 368.45,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction \n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 368.849,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 369.216,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler()\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\" \n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 369.783,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler()\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 370.966,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($)\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 371.51599999999996,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($u)\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 371.783,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($url)\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 372.51599999999996,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlPar)\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 373.283,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParam)\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 373.5,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 373.8,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    v\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 373.95,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 375.099,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump()\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 375.283,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 385.216,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    \n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 385.399,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 386.783,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n\n    \n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 388.58299999999997,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    \n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 388.849,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 390.816,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    \n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 391.099,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 391.983,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    \n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 392.483,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 392.933,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 393.483,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->exec\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 394.45,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute()\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 394.55,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        \n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 397.399,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek\n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 398.416,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek[]\n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 398.983,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['']\n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 399.58299999999997,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dish']\n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 400.033,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishI']\n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 400.51599999999996,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ])\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 401.466,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 403.5,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    \n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 404.649,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 405.5,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    var_dump($urlParameterek);\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 407.2,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n\n\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 407.816,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 423.05,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 423.7,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    \n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 424.566,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 425.366,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 425.649,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 426.58299999999997,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', ]\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 428.033,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 428.7,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 430.733,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 431.25,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction \n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 431.649,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 432.099,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 432.399,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler() \n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 432.866,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler() {\n    \n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 434.483,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler() {\n    redirectToLoginPageIfNotLoggedIn();\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 435.316,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 436.149,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    \n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 437.116,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 440.26599999999996,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    \n\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 440.983,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 443.716,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    \n\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 444.466,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 451.666,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 454.816,
    "fileName": "dish-type-list.phtml",
    "content": "<section class=\"ftco-section\"> \n  <div class=\"container\">\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n        <div class=\"row mb-4 border-bottom border-dark\">\n          <div class=\"d-flex\">\n            <div class=\"desc pl-3\">\n              <div class=\"d-flex text align-items-center\">\n                <h3><span>Levesek</span></h3>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"row mb-4 border-bottom border-dark\">\n          <div class=\"d-flex \">\n            <div class=\"desc pl-3\">\n              <div class=\"d-flex text align-items-center\">\n                <h3><span>Főételek</span></h3>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"row mb-4 border-bottom border-dark\">\n          <div class=\"d-flex \">\n            <div class=\"desc pl-3\">\n              <div class=\"d-flex text align-items-center\">\n                <h3><span>Desszertek</span></h3>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"row mb-4 border-bottom border-dark\">\n          <div class=\"d-flex \">\n            <div class=\"desc pl-3\">\n              <div class=\"d-flex text align-items-center\">\n                <h3><span>Italok</span></h3>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"col-md-12 mb-5 pb-3\">\n      <h3>Új ételtípus létrehozása</h3>\n      <form action=\"/create-dish-type\" method=\"POST\">\n        <div class=\"form-group row\">\n          <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n          <div class=\"col-sm-10\">\n            <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n          </div>\n        </div>\n        <div class=\"form-group row\">\n          <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n          <div class=\"col-sm-10\">\n            <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"></textarea>\n          </div>\n        </div>\n\n        <div class=\"form-group row\">\n          <div class=\"col-sm-10\">\n            <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</section>"
  },
  {
    "timestamp": 457.8,
    "fileName": "dish-type-list.phtml",
    "content": "<section class=\"ftco-section\"> \n  <div class=\"container\">\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n        \n      </div>\n    </div>\n\n    <div class=\"col-md-12 mb-5 pb-3\">\n      <h3>Új ételtípus létrehozása</h3>\n      <form action=\"/create-dish-type\" method=\"POST\">\n        <div class=\"form-group row\">\n          <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n          <div class=\"col-sm-10\">\n            <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n          </div>\n        </div>\n        <div class=\"form-group row\">\n          <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n          <div class=\"col-sm-10\">\n            <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"></textarea>\n          </div>\n        </div>\n\n        <div class=\"form-group row\">\n          <div class=\"col-sm-10\">\n            <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</section>"
  },
  {
    "timestamp": 459.649,
    "fileName": "dish-type-list.phtml",
    "content": "<section class=\"ftco-section\"> \n  <div class=\"container\">\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n      <?php foreach ($params['dishTypes'] as $dishType) : ?>\n          <div class=\"row mb-4 border-bottom border-dark\">\n            <div class=\"d-flex \">\n              <div class=\"desc pl-3\">\n                <div class=\"d-flex text align-items-center\">\n                  <h3><span><?= $dishType['name'] ?></span></h3>\n                </div>\n              </div>\n            </div>\n          </div>\n        <?php endforeach ?>\n      </div>\n    </div>\n\n    <div class=\"col-md-12 mb-5 pb-3\">\n      <h3>Új ételtípus létrehozása</h3>\n      <form action=\"/create-dish-type\" method=\"POST\">\n        <div class=\"form-group row\">\n          <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n          <div class=\"col-sm-10\">\n            <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n          </div>\n        </div>\n        <div class=\"form-group row\">\n          <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n          <div class=\"col-sm-10\">\n            <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"></textarea>\n          </div>\n        </div>\n\n        <div class=\"form-group row\">\n          <div class=\"col-sm-10\">\n            <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</section>"
  },
  {
    "timestamp": 461,
    "fileName": "dish-type-list.phtml",
    "content": "<section class=\"ftco-section\">\n  <div class=\"container\">\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n        <?php foreach ($params['dishTypes'] as $dishType) : ?>\n          <div class=\"row mb-4 border-bottom border-dark\">\n            <div class=\"d-flex \">\n              <div class=\"desc pl-3\">\n                <div class=\"d-flex text align-items-center\">\n                  <h3><span><?= $dishType['name'] ?></span></h3>\n                </div>\n              </div>\n            </div>\n          </div>\n        <?php endforeach ?>\n      </div>\n    </div>\n\n    <div class=\"col-md-12 mb-5 pb-3\">\n      <h3>Új ételtípus létrehozása</h3>\n      <form action=\"/create-dish-type\" method=\"POST\">\n        <div class=\"form-group row\">\n          <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n          <div class=\"col-sm-10\">\n            <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n          </div>\n        </div>\n        <div class=\"form-group row\">\n          <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n          <div class=\"col-sm-10\">\n            <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"></textarea>\n          </div>\n        </div>\n\n        <div class=\"form-group row\">\n          <div class=\"col-sm-10\">\n            <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</section>"
  },
  {
    "timestamp": 470.966,
    "fileName": "dish-type-list.phtml",
    "content": "<section class=\"ftco-section\">\n  <div class=\"container\">\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n        <?php foreach ($params['dishTypes'] as $dishType) : ?>\n          <div class=\"row mb-4 border-bottom border-dark\">\n            <div class=\"d-flex \">\n              <div class=\"desc pl-3\">\n                <div class=\"d-flex text align-items-center\">\n                  <h3><span><?= $dishType['name'] ?></span></h3>\n                </div>\n              </div>\n            </div>\n          </div>\n        <?php endforeach ?>\n      </div>\n    </div>\n\n    <div class=\"col-md-12 mb-5 pb-3\">\n      <h3>Új ételtípus létrehozása</h3>\n      <form action=\"/create-dish-type\" method=\"POST\"> \n        <div class=\"form-group row\">\n          <label for=\"inputName\" class=\"col-sm-2 col-form-label\">Név</label>\n          <div class=\"col-sm-10\">\n            <input type=\"text\" class=\"form-control\" id=\"inputName\" name=\"name\">\n          </div>\n        </div>\n        <div class=\"form-group row\">\n          <label for=\"exampleFormControlTextarea1\" class=\"col-sm-2 col-form-label\">Leírás</label>\n          <div class=\"col-sm-10\">\n            <textarea class=\"form-control\" id=\"exampleFormControlTextarea1\" rows=\"3\" name=\"description\"></textarea>\n          </div>\n        </div>\n\n        <div class=\"form-group row\">\n          <div class=\"col-sm-10\">\n            <button type=\"submit\" class=\"btn btn-primary\">Elküldés</button>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</section>"
  },
  {
    "timestamp": 475.366,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 475.916,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    \n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 476.75,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    []\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 477.283,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 477.966,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 478.599,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 479.599,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', ]\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 480.3,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', '']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 480.75,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 485.58299999999997,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 486.33299999999997,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction \n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 486.866,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 487,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 487.2,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler() {}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 487.75,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler() {\n    \n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 490.51599999999996,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler() {\n    redirectToLoginPageIfNotLoggedIn();\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 490.849,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    \n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 491.233,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n       \n    );\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 492.616,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \n    );\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 494.51599999999996,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 496.45,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`)  \n        VALUES \n        (?, ?, ?);\"\n    );\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 497.733,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\" \n    );\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 503.05,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    \n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 503.75,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n\n        ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 504.849,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n\n    ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 506.716,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        \n\n    ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 512.466,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n\n    ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 513.749,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        \n\n    ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 514.3330000000001,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n\n    ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 516.7330000000001,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 520.033,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    \n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 520.8330000000001,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler']\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 534.2660000000001,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    \n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 534.849,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 536.633,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\n\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 537.2660000000001,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 539.066,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 540.0160000000001,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 593.033,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nreq\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 594.099,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 594.7330000000001,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire \n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 595.533,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './'\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 596.5160000000001,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php;'\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 596.966,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php'\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 597.566,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 597.8660000000001,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishes.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 597.9830000000001,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './dishTypes.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 598.1160000000001,
    "fileName": "index.php",
    "content": "<?php\n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  },
  {
    "timestamp": 603,
    "fileName": "auth.php",
    "content": "<?php\n\nfunction logoutHandler() \n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\n\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}"
  },
  {
    "timestamp": 606,
    "fileName": "dishes.php",
    "content": "<?php\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}"
  },
  {
    "timestamp": 609,
    "fileName": "dishTypes.php",
    "content": "<?php\n\nfunction createDishTypeHandler() \n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}"
  },
  {
    "timestamp": 612,
    "fileName": "index.php",
    "content": "<?php \n\nrequire './router.php';\nrequire './slugifier.php';\nrequire './dishes.php';\nrequire './dishTypes.php';\nrequire './auth.php';\n\n$method = $_SERVER[\"REQUEST_METHOD\"];\n$parsed = parse_url($_SERVER['REQUEST_URI']);\n$path = $parsed['path'];\n\n// Útvonalak regisztrálása\n$routes = [\n    // [method, útvonal, handlerFunction],\n    ['GET', '/', 'homeHandler'],\n    ['GET', '/admin/etel-szerkesztese/{keresoBaratNev}', 'dishEditHandler'],\n    ['GET', '/admin', 'adminDashboardHandler'],\n    ['POST', '/login', 'loginHandler'],\n    ['POST', '/update-dish/{dishId}', 'updateDishHandler'],\n    ['GET', '/admin/uj-etel-letrehozasa', 'dishCreatePageHandler'],\n    ['POST', '/create-dish', 'createDishHandler'],\n    ['POST', '/delete-dish/{dishId}', 'deleteDishHandler'],\n    ['GET', '/admin/etel-tipusok', 'adminDishTypeHandler'],\n    ['POST', '/create-dish-type', 'createDishTypeHandler'],\n    ['POST', '/logout', 'logoutHandler'],\n];\n\n// Útvonalválasztó inicializálása\n$dispatch = registerRoutes($routes);\n$matchedRoute = $dispatch($method, $path);\n$handlerFunction = $matchedRoute['handler'];\n$handlerFunction($matchedRoute['vars']);\n\nfunction logoutHandler()\n{\n    session_start();\n    $params = session_get_cookie_params();\n    setcookie(session_name(), '', 0, $params['path'], $params['domain'], $params['secure'], isset($params['httponly']));\n    session_destroy();\n    header('Location: /');\n}\n\nfunction createDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishTypes` \n        (`name`, `slug`, `description`) \n        VALUES \n        (?, ?, ?);\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        slugify($_POST['name']),\n        $_POST['description'],\n    ]);\n    header('Location: /admin/etel-tipusok');\n}\n\nfunction adminDishTypeHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render(\"dish-type-list.phtml\", [\n            'dishTypes' => $dishTypes,\n        ])\n    ]);\n}\n\nfunction deleteDishHandler($urlParameterek)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"DELETE FROM `dishes` WHERE id = ?\");\n    $stmt->execute([\n        $urlParameterek['dishId']\n    ]);\n    header('Location: /admin');\n}\n\nfunction createDishHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"INSERT INTO `dishes` \n        (`name`, `slug`, `description`, `price`, `isActive`, `dishTypeId`) \n        VALUES \n        (:nev, :slug, :leiras, :ar, :aktiv, :dishTypeId);\"\n    );\n\n    $stmt->execute([\n        \"nev\" => $_POST['name'],\n        \"slug\" => slugify($_POST['name']),\n        \"leiras\" => $_POST['description'],\n        \"ar\" =>  $_POST['price'],\n        \"aktiv\" =>  (int)isset($_POST['isActive']),\n        \"dishTypeId\" =>  $_POST['dishTypeId'],\n    ]);\n    header('Location: /admin');\n}\n\n// Handler függvények deklarálása\nfunction dishCreatePageHandler()\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n    echo render('admin-wrapper.phtml', [\n        'content' => render('create-dish.phtml', [\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction redirectToLoginPageIfNotLoggedIn()\n{\n    if (isLoggedIn()) {\n        return;\n    }\n\n    header('Location: /admin');\n    exit;\n}\n\nfunction updateDishHandler($urlParams)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\n        \"UPDATE `dishes` SET\n            name = ?,\n            slug = ?,\n            description = ?,\n            price = ?,\n            dishTypeId = ?,\n            isActive = ?\n        WHERE id = ?\"\n    );\n\n    $stmt->execute([\n        $_POST['name'],\n        $_POST['slug'],\n        $_POST['description'],\n        $_POST['price'],\n        $_POST['dishTypeId'],\n        (int)isset($_POST['isActive']),\n        $urlParams['dishId']\n    ]);\n\n    header('Location: /admin');\n}\n\nfunction loginHandler()\n{\n    $pdo = getConnection();\n    $stmt = $pdo->prepare('SELECT * FROM users WHERE email = ?');\n    $stmt->execute([$_POST['email']]);\n    $user = $stmt->fetch();\n    if (!$user) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    if (!password_verify($_POST['password'], $user['password'])) {\n        header('Location: /admin?info=invalidCredentials');\n        return;\n    }\n\n    session_start();\n    $_SESSION['userId'] = $user['id'];\n    header('Location: /admin');\n}\n\n// https://kodbazis.hu/php-az-alapoktol/bejelentkezesi-felulet-es-felhasznalo-kezeles\nfunction isLoggedIn()\n{\n    if (!isset($_COOKIE[session_name()])) {\n        return false;\n    }\n\n    if (!isset($_SESSION)) {\n        session_start();\n    }\n    if (!isset($_SESSION['userId'])) {\n        return false;\n    }\n\n    return true;\n}\n\nfunction adminDashboardHandler()\n{\n    if (!isLoggedIn()) {\n        echo render('wrapper.phtml', [\n            'content' => render('login.phtml')\n        ]);\n        return;\n    }\n\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM dishes ORDER BY id DESC\");\n    $stmt->execute();\n    $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('dish-list.phtml', [\n            'dishes' => $dishes\n        ])\n    ]);\n}\n\nfunction homeHandler()\n{\n    $pdo = getConnection();\n    $dishTypes = getAllDishTypes($pdo);\n\n    foreach ($dishTypes as $index => $dishType) {\n        $stmt = $pdo->prepare(\"SELECT * FROM dishes WHERE isActive = 1 AND dishTypeId = ?\");\n        $stmt->execute([$dishType['id']]);\n        $dishes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n        $dishTypes[$index]['dishes'] = $dishes;\n    }\n\n    echo render(\"wrapper.phtml\", [\n        'content' => render('public-menu.phtml', [\n            'dishTypesWithDishes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction dishEditHandler($vars)\n{\n    redirectToLoginPageIfNotLoggedIn();\n    $pdo = getConnection();\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishes` WHERE slug = ?\");\n    $stmt->execute([$vars['keresoBaratNev']]);\n    $dish = $stmt->fetch(PDO::FETCH_ASSOC);\n\n    $dishTypes = getAllDishTypes($pdo);\n\n    echo render('admin-wrapper.phtml', [\n        'content' => render('edit-dish.phtml', [\n            'dish' => $dish,\n            'dishTypes' => $dishTypes\n        ])\n    ]);\n}\n\nfunction getAllDishTypes($pdo)\n{\n    $stmt = $pdo->prepare(\"SELECT * FROM `dishTypes`\");\n    $stmt->execute();\n    $dishTypes = $stmt->fetchAll(PDO::FETCH_ASSOC);\n    return $dishTypes;\n}\n\nfunction notFoundHandler()\n{\n    http_response_code(404);\n    echo render('wrapper.phtml', [\n        'content' => render('404.phtml')\n    ]);\n}\n\nfunction render($path, $params = [])\n{\n    ob_start();\n    require __DIR__ . '/views/' . $path;\n    return ob_get_clean();\n}\n\nfunction getConnection()\n{\n    return new PDO(\n        'mysql:host=' . $_SERVER['DB_HOST'] . ';dbname=' . $_SERVER['DB_NAME'],\n        $_SERVER['DB_USER'],\n        $_SERVER['DB_PASSWORD']\n    );\n}\n"
  }
]
